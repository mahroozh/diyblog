{% extends 'blog/base.html' %}
{% block title %}{{ post.title }}{% endblock %}
{% block content %}
<article>
  <h2>{{ post.title }}</h2>
  <p class="meta">
    By 
    {% if post.author %}
      <a href="{% url 'blog:blogger_detail' post.author.pk %}">{{ post.author.name }}</a>
    {% else %}
      <em>Unknown author</em>
    {% endif %}
    — {{ post.created_at|date:"M j, Y H:i" }}
  </p>
  <div class="post-content">
    <p>{{ post.content }}</p>
  </div>
</article>

<section class="comments">
  <h3>Comments</h3>
  {% if comments %}
    <ol>
      {% for c in comments %}
        <li>
          <p><strong>{% if c.author %}{{ c.author.username }}{% else %}Anonymous{% endif %}</strong> — {{ c.created_at|date:"M j, Y H:i" }}</p>
          <p>{{ c.text }}</p>
        </li>
      {% endfor %}
    </ol>
  {% else %}
    <p>No comments yet.</p>
  {% endif %}

  {% if user.is_authenticated %}
    <p><a href="{% url 'blog:create_comment' post.pk %}">Add a comment</a></p>
  {% else %}
    <p><a href="{% url 'login' %}?next={% url 'blog:create_comment' post.pk %}">Log in to add a comment</a></p>
  {% endif %}
</section>
{% endblock %}
